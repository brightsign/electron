From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Tariq Bashir <120014322+t-bashir-bs@users.noreply.github.com>
Date: Fri, 3 May 2024 10:25:41 +0100
Subject: OS-16623 add setopacity to wayland toplevel window

This patch adds a setopacity method to the wayland_toplevel_window class to
allow the opacity of the window to be set.

diff --git a/ui/ozone/platform/wayland/host/wayland_toplevel_window.cc b/ui/ozone/platform/wayland/host/wayland_toplevel_window.cc
index b866a17d0a7786197227a6346ea1f257576c7278..629adb3b08877f60b815bab6aed101b1708ba263 100644
--- a/ui/ozone/platform/wayland/host/wayland_toplevel_window.cc
+++ b/ui/ozone/platform/wayland/host/wayland_toplevel_window.cc
@@ -318,6 +318,11 @@ void WaylandToplevelWindow::SizeConstraintsChanged() {
   SetSizeConstraints();
 }
 
+void WaylandToplevelWindow::SetOpacity(float opacity) {
+  root_surface()->set_opacity(opacity);
+  root_surface()->set_blending(true);
+}
+
 void WaylandToplevelWindow::SetZOrderLevel(ZOrderLevel order) {
   if (shell_toplevel_)
     shell_toplevel_->SetZOrder(order);
diff --git a/ui/ozone/platform/wayland/host/wayland_toplevel_window.h b/ui/ozone/platform/wayland/host/wayland_toplevel_window.h
index f39a9a89bfb48ff9cf953bf3bc0e596d43f54856..09159b7726f92efe60f4c3262359ffbb2f41437c 100644
--- a/ui/ozone/platform/wayland/host/wayland_toplevel_window.h
+++ b/ui/ozone/platform/wayland/host/wayland_toplevel_window.h
@@ -124,6 +124,7 @@ class WaylandToplevelWindow : public WaylandWindow,
   void SizeConstraintsChanged() override;
   // `SetZOrderLevel()` must be called on `z_order_` in
   // `SetUpShellIntegration()`.
+  void SetOpacity(float opacity) override;
   void SetZOrderLevel(ZOrderLevel order) override;
   ZOrderLevel GetZOrderLevel() const override;
   void SetShape(std::unique_ptr<ShapeRects> native_shape,
